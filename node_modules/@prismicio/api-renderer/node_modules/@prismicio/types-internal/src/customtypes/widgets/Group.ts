import * as t from "io-ts"

import { WidgetKey } from "../../documents/widgets"
import { StringOrNull } from "../../validators"
import NestableWidget from "./nestable/NestableWidget"
import { WidgetTypes } from "./WidgetTypes"

const GroupConfig = t.exact(
	t.partial({
		label: StringOrNull,
		repeat: t.boolean,
		fields: t.record(WidgetKey, NestableWidget),
	}),
)
type GroupConfig = t.TypeOf<typeof GroupConfig>

const Group = t.exact(
	t.intersection([
		t.type({
			type: t.literal(WidgetTypes.Group),
		}),
		t.partial({
			fieldset: StringOrNull,
			icon: t.string,
			description: t.string,
			config: GroupConfig,
		}),
	]),
)
type Group = t.TypeOf<typeof Group>

export default Group
