import type { ExternalLink } from "@prismicio/types-internal/lib/documents/widgets/nestable/Link"

import type { AnyLinkDef, LinkRenderer, WebLinkDef } from "../../../models"

const ExternalLinkRenderer: LinkRenderer<WebLinkDef, ExternalLink> = {
	renderV1(link: ExternalLink): unknown {
		const target = typeof link.target === "string" ? { target: link.target } : {}
		return {
			type: "Link.web",
			value: {
				url: link.url,
				...target,
			},
		}
	},

	renderV2(_def: WebLinkDef | AnyLinkDef, link: ExternalLink): unknown {
		const partialRender = {
			link_type: "Web",
			url: link.url,
		}

		return Object.assign(partialRender, typeof link.target === "string" ? { target: link.target } : {})
	},

	renderMocks(def: WebLinkDef | AnyLinkDef, link: ExternalLink): unknown {
		return this.renderV2(def, link)
	},
}

export default ExternalLinkRenderer
