import type Link from "@prismicio/types-internal/lib/customtypes/widgets/nestable/Link"
import { addType, nullable } from "@prismicio/types-internal/lib/validators/function"
import * as t from "io-ts"

export const AnyLinkDefType = "ConfigAnyLinkDef"
export const AnyLinkDef = addType(
	t.partial({
		select: nullable(t.literal("any")),
	}),
	AnyLinkDefType,
)
export type AnyLinkDef = t.OutputOf<typeof AnyLinkDef>

export function fromAnyLink(link: Link): AnyLinkDef {
	if (link.config?.select) throw new Error("Invalid link type provided, should not be of type any")
	return AnyLinkDef.encode({ select: "any" })
}
