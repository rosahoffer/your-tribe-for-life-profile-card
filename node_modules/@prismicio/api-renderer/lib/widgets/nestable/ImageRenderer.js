"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("../../utils");
function renderImageContentView(imageContentView, ctx) {
    return {
        dimensions: {
            width: imageContentView.width,
            height: imageContentView.height,
        },
        alt: (0, utils_1.writeEmptyStringOrNull)(imageContentView.alt, ctx.emptyStringInsteadOfNull),
        copyright: (0, utils_1.writeEmptyStringOrNull)(imageContentView.credits, ctx.emptyStringInsteadOfNull),
        url: ctx.urlRewriter.rewriteImageUrl(imageContentView),
    };
}
const ImageRenderer = (ctx) => ({
    renderV1(content) {
        if (content.thumbnails) {
            const views = Object.entries(content.thumbnails).reduce((acc, [k, v]) => {
                return {
                    ...acc,
                    [k.toLowerCase()]: renderImageContentView(v, ctx),
                };
            }, {});
            return {
                type: "Image",
                value: { main: renderImageContentView(content, ctx), views: views },
            };
        }
        return {
            type: "Image",
            value: { main: renderImageContentView(content, ctx), views: [] },
        };
    },
    renderV2(_def, content) {
        const main = renderImageContentView(content, ctx);
        if (content.thumbnails && content.thumbnails) {
            const views = Object.entries(content.thumbnails).reduce((acc, [k, v]) => {
                return Object.assign(acc, { [k]: renderImageContentView(v, ctx) });
            }, {});
            return Object.assign(main, views);
        }
        return main;
    },
    renderDefault(def) {
        return def.config.thumbnails.reduce((acc, name) => {
            return {
                ...acc,
                [name]: {},
            };
        }, {});
    },
    renderMocks(def, content) {
        return this.renderV2(def, content);
    },
});
exports.default = ImageRenderer;
