"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ImageLinkRenderer = exports.FileLinkRenderer = exports.ExternalLinkRenderer = exports.DocumentLinkRenderer = void 0;
const tslib_1 = require("tslib");
const Link_1 = require("@prismicio/types-internal/lib/documents/widgets/nestable/Link");
const ApiModel_1 = require("../../../models/ApiModel");
const DocumentLinkRenderer_1 = tslib_1.__importDefault(require("./DocumentLinkRenderer"));
exports.DocumentLinkRenderer = DocumentLinkRenderer_1.default;
const ExternalLinkRenderer_1 = tslib_1.__importDefault(require("./ExternalLinkRenderer"));
exports.ExternalLinkRenderer = ExternalLinkRenderer_1.default;
const FileLinkRenderer_1 = tslib_1.__importDefault(require("./FileLinkRenderer"));
exports.FileLinkRenderer = FileLinkRenderer_1.default;
const ImageLinkRenderer_1 = tslib_1.__importDefault(require("./ImageLinkRenderer"));
exports.ImageLinkRenderer = ImageLinkRenderer_1.default;
const LinkRenderer = (ctx) => ({
    renderV1(link, fetch) {
        const encoded = Link_1.Link.encode(link.value);
        if (encoded.__TYPE__ === "ImageLink") {
            return (0, ImageLinkRenderer_1.default)(ctx).renderV1(encoded);
        }
        else if (encoded.__TYPE__ === "DocumentLink") {
            return (0, DocumentLinkRenderer_1.default)(ctx).renderV1(encoded, fetch);
        }
        else if (encoded.__TYPE__ === "FileLink") {
            return (0, FileLinkRenderer_1.default)(ctx).renderV1(encoded);
        }
        else if (encoded.__TYPE__ === "ExternalLink") {
            return ExternalLinkRenderer_1.default.renderV1(encoded);
        }
        else {
            throw new Error(`No rendered found for link ${JSON.stringify(link)}`); // normally unreachable
        }
    },
    renderV2(def, content, fetch) {
        const encoded = Link_1.Link.encode(content.value);
        if (encoded.__TYPE__ === "ImageLink" && ((0, ApiModel_1.isMediaLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def))) {
            return (0, ImageLinkRenderer_1.default)(ctx).renderV2(def.config, encoded);
        }
        else if (((0, ApiModel_1.isDocumentLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def)) && encoded.__TYPE__ === "DocumentLink") {
            return (0, DocumentLinkRenderer_1.default)(ctx).renderV2(def.config, encoded, fetch);
        }
        else if (((0, ApiModel_1.isMediaLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def)) && encoded.__TYPE__ === "FileLink") {
            return (0, FileLinkRenderer_1.default)(ctx).renderV2(def.config, encoded);
        }
        else if (((0, ApiModel_1.isWebLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def)) && encoded.__TYPE__ === "ExternalLink") {
            return ExternalLinkRenderer_1.default.renderV2(def.config, encoded);
        }
        else {
            return this.renderDefault(def);
        }
    },
    renderDefault(def) {
        switch (def.config.__TYPE__) {
            case "ConfigMediaLinkDef":
                return {
                    link_type: "Media",
                };
            case "ConfigDocumentLinkDef":
                return {
                    link_type: "Document",
                };
            case "ConfigWebLinkDef":
                return {
                    link_type: "Web",
                };
            case "ConfigAnyLinkDef":
                return {
                    link_type: "Any",
                };
        }
    },
    renderMocks(def, content) {
        const encoded = Link_1.Link.encode(content.value);
        if (encoded.__TYPE__ === "ImageLink" && ((0, ApiModel_1.isMediaLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def))) {
            return (0, ImageLinkRenderer_1.default)(ctx).renderMocks(def.config, encoded);
        }
        else if (((0, ApiModel_1.isDocumentLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def)) && encoded.__TYPE__ === "DocumentLink") {
            return (0, DocumentLinkRenderer_1.default)(ctx).renderMocks(def.config, encoded);
        }
        else if (((0, ApiModel_1.isMediaLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def)) && encoded.__TYPE__ === "FileLink") {
            return (0, FileLinkRenderer_1.default)(ctx).renderMocks(def.config, encoded);
        }
        else if (((0, ApiModel_1.isWebLinkDef)(def) || (0, ApiModel_1.isAnyLinkDef)(def)) && encoded.__TYPE__ === "ExternalLink") {
            return ExternalLinkRenderer_1.default.renderMocks(def.config, encoded);
        }
        else {
            return this.renderDefault(def);
        }
    },
});
exports.default = LinkRenderer;
