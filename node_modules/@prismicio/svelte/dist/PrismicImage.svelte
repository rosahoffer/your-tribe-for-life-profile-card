<script>import {
  asImageWidthSrcSet,
  asImagePixelDensitySrcSet,
  isFilled
} from "@prismicio/client";
export let field;
export let imgixParams = {};
export let alt = void 0;
export let fallbackAlt = void 0;
export let width = void 0;
export let height = void 0;
export let widths = void 0;
export let pixelDensities = void 0;
let src = void 0;
let srcset = void 0;
let resolvedWidth = void 0;
let resolvedHeight = void 0;
$: {
  if (isFilled.imageThumbnail(field)) {
    const castInt = (input) => {
      if (typeof input === "number" || typeof input === "undefined" || input === null) {
        return input;
      } else {
        const parsed = Number.parseInt(input);
        if (Number.isNaN(parsed)) {
          return void 0;
        } else {
          return parsed;
        }
      }
    };
    const ar = field.dimensions.width / field.dimensions.height;
    const castedWidth = castInt(width);
    const castedHeight = castInt(height);
    resolvedWidth = castedWidth ?? field.dimensions.width;
    resolvedHeight = castedHeight ?? field.dimensions.height;
    if (castedWidth != null && castedHeight == null) {
      resolvedHeight = castedWidth / ar;
    } else if (castedWidth == null && castedHeight != null) {
      resolvedWidth = castedHeight * ar;
    }
    if (widths || !pixelDensities) {
      const res = asImageWidthSrcSet(field, {
        ...imgixParams,
        widths: widths === "defaults" ? void 0 : widths
      });
      src = res.src;
      srcset = res.srcset;
    } else if (pixelDensities) {
      const res = asImagePixelDensitySrcSet(field, {
        ...imgixParams,
        pixelDensities: pixelDensities === "defaults" ? void 0 : pixelDensities
      });
      src = res.src;
      srcset = res.srcset;
    }
  }
}
</script>

<!--
  @component
  Component to render a Prismic image field as an `img` element with `width`, `height`, `alt`, `src`, and `srcset` attributes.

  @example Rendering an image field:
	```svelte
		<PrismicImage
			field={document.data.example_image}
			imgixParams={{ sat: -100 }}
		/>
	```
-->

{#if isFilled.imageThumbnail(field)}
	<img
		{src}
		{srcset}
		alt={alt ?? (field.alt || fallbackAlt)}
		width={resolvedWidth}
		height={resolvedHeight}
		{...$$restProps}
	/>
{/if}
